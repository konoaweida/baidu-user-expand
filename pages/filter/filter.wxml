<!--pages/filter/filter.wxml-->
<navigation-header 
  bindback="onHeaderBack" 
  showBackButton="{{true}}" 
  backColor="{{1}}"
  needDefaultBack="{{false}}"></navigation-header>

<!-- 筛选内容容器 -->
<view class="filter-container">
  <!-- 星座筛选项 -->
  <view class="filter-zodiac" bindtap="openConstellationPopup">
    <view class="item-label">
      <view class="filter-icon">
        <image src="../../assets/image/路径 1.png" mode="aspectFit" style="width: 100%; height: 100%"></image>
      </view>
      <text class="filter-text">星座</text>
    </view>
    <view class="item-value zodiac">
      <text>{{zodiac || ''}}</text>
    </view>
    <view class="arrow-right">
      <image src="../../assets/image/右.png" mode="aspectFit" style="width: 100%; height: 100%"></image>
    </view>
  </view>

  <!-- 性别筛选项 -->
  <view class="filter-gender">
    <view class="item-label">
      <view class="filter-icon">
        <image src="../../assets/image/画板 1.png" mode="aspectFit" style="width: 100%; height: 100%"></image>
      </view>
      <text class="filter-text">性别</text>
    </view>
    <view class="gender-radio-group">
      <view 
        class="radio-item" 
        wx:for="{{genderOptions}}" 
        wx:key="value" 
        bindtap="selectGender" 
        data-value="{{item.value}}"
      >
        <view class="radio-circle {{gender === item.value ? 'checked' : ''}}"></view>
        <text class="radio-text {{gender === item.value ? 'checked-text' : ''}}">{{item.text}}</text>
      </view>
    </view>
  </view>

  <!-- 收入筛选项 -->
  <view class="filter-income">
    <view class="item-label">
      <view class="filter-icon">
        <image src="../../assets/image/画板 3.png" mode="aspectFit" style="width: 100%; height: 100%"></image>
      </view>
      <text class="filter-text">收入</text>
    </view>
    <view class="item-slider">
      <van-slider value="{{[incomeLeft, incomeRight]}}" bind:drag="onIncomeDrag" bind:change='onIncomeChange' range use-button-slot inactive-color="#E6E6E6" active-color="#7A4FD6" bar-height="6rpx" max="10000" min="0" step="100">
        <view class="slider-button" slot="left-button">
          <image class="slider-icon" src="{{incomeLeft === 0 && incomeRight === 0 ? '../../assets/image/游标 2.png' : '../../assets/image/游标 1.png'}}" mode="aspectFit"/>
          <text class="slider-value">{{incomeLeft}}</text>
        </view>
        <view class="slider-button" slot="right-button">
          <image class="slider-icon" src="{{incomeLeft === 0 && incomeRight === 0 ? '../../assets/image/游标 2.png' : '../../assets/image/游标 1.png'}}" mode="aspectFit"/>
          <text class="slider-value">{{incomeRight}}</text>
        </view>
      </van-slider>
      <view class="slider-labels">
        <text class="{{incomeLeft === 0 || incomeRight === 0 ? 'slider-label-active' : ''}}">0</text>
        <text class="{{incomeLeft === 5000 || incomeRight === 5000 ? 'slider-label-active' : ''}}">5000</text>
        <text class="{{incomeLeft === 10000 || incomeRight === 10000 ? 'slider-label-active' : ''}}">以上</text>
      </view>
    </view>
  </view>

  <!-- 年龄筛选项 -->
  <view class="filter-age">
    <view class="item-label">
      <view class="filter-icon">
        <image src="../../assets/image/画板 2.png" mode="aspectFit" style="width: 100%; height: 100%"></image>
      </view>
      <text class="filter-text">年龄</text>
    </view>
    <view class="item-slider">
      <van-slider value="{{[ageLeft, ageRight]}}" bind:drag="onAgeDrag" bind:change='onAgeChange' step="1" range use-button-slot inactive-color="#E6E6E6" active-color="#7A4FD6" bar-height="6rpx" max="60" min="0">
        <view class="slider-button" slot="left-button">
          <image class="slider-icon" src="{{ageLeft === 0 && ageRight === 0 ? '../../assets/image/游标 2.png' : '../../assets/image/游标 1.png'}}" mode="aspectFit"/>
          <text class="slider-value">{{ageLeft}}</text>
        </view>
        <view class="slider-button" slot="right-button">
          <image class="slider-icon" src="{{ageLeft === 0 && ageRight === 0 ? '../../assets/image/游标 2.png' : '../../assets/image/游标 1.png'}}" mode="aspectFit"/>
          <text class="slider-value">{{ageRight}}</text>
        </view>
      </van-slider>
      <view class="slider-labels">
        <text class="{{ageLeft === 0 || ageRight === 0 ? 'slider-label-active' : ''}}">0</text>
        <text class="{{ageLeft === 20 || ageRight === 20 ? 'slider-label-active' : ''}}">20</text>
        <text class="{{ageLeft === 40 || ageRight === 40 ? 'slider-label-active' : ''}}">40</text>
        <text class="{{ageLeft === 60 || ageRight === 60 ? 'slider-label-active' : ''}}">60</text>
      </view>
    </view>
  </view>
</view>

<!-- 按钮 -->
<view class="bottom-btn">
  <text class="resect-text" bindtap="onReset">重置</text>
  <text class="confirm-text" bindtap="onConfirm">完成</text>
</view>

<!-- 星座选择弹出层 -->
<view class="popup-mask {{showConstellationPopup ? 'show' : ''}}" bindtap="closeConstellationPopup"></view>
<view class="popup {{showConstellationPopup ? 'show' : ''}}">
  <view class="popup-header">
    <view class="header-top"></view>
    <text>星座</text>
    <view class="close-btn" bindtap="closeConstellationPopup">
      <image src="../../assets/image/关闭.png" mode="aspectFit" style="width: 100%; height: 100%"></image>
    </view>
  </view>
  <view class="popup-content">
    <view class="constellation-buttons">
      <!-- wx:for 遍历星座列表 -->
      <view 
        wx:for="{{constellationList}}" 
        wx:key="*this"
        class="constellation-btn {{selectedConstellation === item ? 'active' : ''}}" 
        bindtap="selectConstellation" 
        data-value="{{item}}"
      >{{item}}</view>
    </view>
  </view>
  <view class="popup-footer">
    <button class="confirm-btn" bindtap="confirmConstellation">确定</button>
  </view>
</view>
